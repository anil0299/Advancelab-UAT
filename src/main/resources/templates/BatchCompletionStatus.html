<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CyberGyan</title>
<link rel="stylesheet" href="" th:href="@{/css/StudentApproval.css}" />
<link th:href="@{/css/bootstrap.css}" rel="stylesheet">
<link th:href="@{/css/datatables.css}" rel="stylesheet">
<script type="text/javascript" th:src="@{/js/bootstrap.bundle.min.js}"></script>
<script type="text/javascript" th:src="@{/js/jquery-3.7.1.min.js}"></script>
<link rel="stylesheet" th:href="@{/fontawesome/css/all.min.css}">
<script type="text/javascript" th:src="@{/js/datatables.js}"></script>
<style>
.progress-bar-container {
	width: 100%;
	height: 20px;
	background-color: #f2f2f2;
	border-radius: 4px;
	margin-bottom: 10px;
}

.progress-bar {
	height: 100%;
	line-height: 20px;
	color: white;
	text-align: right;
	border-radius: 4px;
	background-color: #4CAF50;
}
</style>
</head>
<body style="background-color: rgb(158, 191, 251);">
	<div class=navcontainer>
		<div class="img-fluid">
			<img style="width: 90px; margin-left: 30px;" src=""
				th:src="@{/images/cdac-wo-bg.png}" alt="">
			<form th:action="@{/logout}" method="post"
				style="float: right; margin-top: 25px; margin-right: 10px">
				<a th:href="@{/welcome}" class="btn btn-primary mb-2"
					style="margin-top: 10px;">Site Home</a> <input type="submit"
					class="btn btn-primary" value="Logout" />
			</form>
		</div>
	</div>
	<div class="lab-desc">
		<a href="AdminHome" style="color: white; text-decoration: none;">Home</a>&nbsp;&nbsp;&nbsp;&nbsp;
		<a class="nav-link dropdown-toggle text-white " href="#"
			id="navbarDropdown" role="button" data-bs-toggle="dropdown"
			aria-expanded="false"> E-LAB Details </a>
		<ul class="dropdown-menu bg-dark" aria-labelledby="navbarDropdown">
			<li><a class="dropdown-item " href="AddExercise">Add
					Exercise</a></li>
			<li><a class="dropdown-item  " href="exercisedetails">View
					Exercise details</a></li>
			<li><a class="dropdown-item" href="addvm">Add VM</a></li>
			<li><a class="dropdown-item" href="vmdetails">View VM
					details</a></li>
			<li><a class="dropdown-item" href="LabDetails">View E-LAB
					Details</a></li>
			<li>
				<hr class="dropdown-divider">
			</li>
		</ul>
		<a class="nav-link dropdown-toggle text-white" href="#"
			id="navbarDropdown" role="button" data-bs-toggle="dropdown"
			aria-expanded="false"> Assignment </a>
		<ul class="dropdown-menu bg-dark" aria-labelledby="navbarDropdown">
			<li><a class="dropdown-item" href="AssignBatch">Assign Batch</a></li>
			<li><a class="dropdown-item" href="assignExercise">Assign
					Exercise</a></li>
			<li><a class="dropdown-item" href="Batchexercise">View
					Batchwise Exercise</a></li>
			<li>
				<hr class="dropdown-divider">
			</li>
		</ul>
		<a class="nav-link dropdown-toggle text-white" href="#"
			id="navbarDropdown" role="button" data-bs-toggle="dropdown"
			aria-expanded="false"> Registration Approval </a>
		<ul class="dropdown-menu bg-dark" aria-labelledby="navbarDropdown">
			<li><a class="dropdown-item" href="StudentApproval">Student
					Approval</a></li>
			<li><a class="dropdown-item" href="TeacherApproval">Teacher
					Approval</a></li>
			<li>
				<hr class="dropdown-divider">
			</li>
		</ul>
		<a class="nav-link dropdown-toggle text-white " href="#"
			id="navbarDropdown" role="button" data-bs-toggle="dropdown"
			aria-expanded="false"> Center Dashboard </a>
		<ul class="dropdown-menu bg-dark" aria-labelledby="navbarDropdown">
			<li><a class="dropdown-item " href="CenterDetails">Center
					Details</a></li>
			<li><a class="dropdown-item " href="AddCourse">Add Course</a></li>
			<li>
				<hr class="dropdown-divider">
			</li>
		</ul>
		<a class="nav-link dropdown-toggle text-white " href="#"
			id="navbarDropdown" role="button" data-bs-toggle="dropdown"
			aria-expanded="false"> Submissions </a>
		<ul class="dropdown-menu bg-dark" aria-labelledby="navbarDropdown">
			<li><a class="dropdown-item " href="folders">Advance Lab</a></li>
			<li><a class="dropdown-item " href="basiclab">Basic Lab</a></li>
			<li>
				<hr class="dropdown-divider">
			</li>
		</ul>
		<a class="active" href="ExerciseCompletion" style="color: white;">Reports </a>
		<a class="nav-link dropdown-toggle text-white" href="#"
			id="navbarDropdown" role="button" data-bs-toggle="dropdown"
			aria-expanded="false"> Exercise Content </a>
		<ul class="dropdown-menu bg-dark" aria-labelledby="navbarDropdown">
			<li><a class="dropdown-item" href="AddExerciseContent">Add Exercise Content</a></li>
			<li><a class="dropdown-item" href="AddExerciseImage">Add Exercise Image</a></li>
			<li><a class="dropdown-item" href="updateExerciseContent">Update Exercise Content</a></li>
			<li>
				<hr class="dropdown-divider">
			</li>
		</ul>
		<a href="StudentTrackTime" style="color: white; text-decoration: none;">StudentTrackTime</a>&nbsp;&nbsp;&nbsp;&nbsp;
		<a href="deleteAllVmDetails" style="color: white; text-decoration: none;">Delete All VM Details</a>&nbsp;&nbsp;&nbsp;&nbsp;
	</div>
	<div class="card">
			<div class="card-header" style="background-color: white;">
				<h1 style="font-family: Times New Roman;" class="text-center">
					<b>Batch Completion Status</b>
				</h1>
			</div>
			<div class="card-body" style="background-color: rgb(205, 214, 224);"
				id="printableArea">
				
		        <div class="mb-3 text-center mx-auto" style="width: 200px;">
				    <label for="batchSelect" class="form-label"><strong>Select Batch:</strong></label>
				    <select class="form-select" id="batchSelect" onchange="getStudentsByBatch()">
					    <option value="">Select Batch</option>
					    <!-- Sort distinct batches in ascending order -->
					    <th:block th:with="sortedBatches=${distinctBatches.stream().sorted().collect(T(java.util.stream.Collectors).toList())}">
					        <!-- Iterate over sorted distinct batches and create options dynamically -->
					        <th:block th:each="batch : ${sortedBatches}">
					            <option th:value="${batch}" th:text="'Batch ' + ${batch}"></option>
					        </th:block>
					    </th:block>
					</select>
				</div>
		        <hr>
		        <div>			   
				    <input class="form-control text-center mx-auto" style="width: 400px;" id="searchInput" type="search" placeholder="Search Students..." aria-label="Search">
				</div>
				<hr>
				<div class="table-responsive">
				    <table id="dtBasicExample" class="table table-hover table-light table-bordered">
				        <thead>
				            <tr class="table-info">
				                <th class="text-center">S.No.</th>
				                <th class="text-center">ID</th>
				                <th class="text-center">First Name</th>
				                <th class="text-center">Last Name</th>
				                <th class="text-center">E-Mail</th>
				                <th class="text-center">Mobile Number</th>
				                <th class="text-center">Basic Level Completion Status</th>			                
				                <th class="text-center">E-Lab Completion Status</th>
				                <th class="text-center">Quiz Completion Status</th>
				            </tr>
				        </thead>
				       <tbody id="studentTableBody">
			            	
						</tbody>
				    </table>
				</div>
                <script>
				    $(document).ready(function() {
				        $('#searchInput').on('input', function() {
				            var searchText = $(this).val().toLowerCase();
				            $('table tbody tr').each(function() {
				                var rowText = $(this).text().toLowerCase();
				                $(this).toggle(rowText.indexOf(searchText) > -1);
				            });
				        });
				    });
				</script>
				<script>
				    function getStudentsByBatch() {
				        var selectedBatch = document.getElementById("batchSelect").value;
				        if (selectedBatch) {
				            // Make an AJAX call to fetch students for the selected batch
				            $.ajax({
				                type: "GET",
				                url: "/getStudentsByBatch?batch=" + selectedBatch,
				                success: function (data) {
				                    // Update the table body with the fetched student data
				                    var tableBody = document.getElementById("studentTableBody");
				                    tableBody.innerHTML = data;
				                },
				                error: function (xhr, status, error) {
				                    console.error("Error fetching students: " + error);
				                }
				            });
				        }
				    }
				</script>
				<script>
				    function countEntries() {
				        var tableBody = document.getElementById("studentTableBody");
				        var rowCount = tableBody.getElementsByTagName("tr").length;
				        console.log("Number of entries: " + rowCount);
				    }
				</script>
				
				<script>
				    $(document).ready(function() {
				        // Listen for changes in the batch select dropdown
				        $('#batchSelect').change(function() {
				            var selectedBatch = $(this).val();
				            
				            // Fetch completion status data for the selected batch using AJAX
				            $.ajax({
				                url: '/getCompletionStatus', // Change the URL to your endpoint that fetches completion status
				                type: 'GET',
				                data: { batch: selectedBatch },
				                success: function(data) {
				                    // Update the table with the new completion status data
				                    updateTable(data);
				                },
				                error: function(xhr, status, error) {
				                    console.error('Error fetching completion status:', error);
				                }
				            });
				        });
				        
				        
				
				    // Function to update the table with new data
				    function updateTable(data) {
				        // Update the table body with the new completion status data
				    }
				</script>
				
				<div class="text-center">
				<button onclick="downloadExcel()" class="btn btn-primary mb-2"
					style="margin-top: 8px;">
					<i class="fa fa-download"></i> Download Excel
				</button>
				<a href="javascript:void(0);" class="btn btn-primary mb-2"
					style="margin-top: 8px;" onclick="printPageArea('printableArea')"><span
					class="glyphicon glyphicon-print" aria-hidden="true"></span> Print</a>
				<a th:href="@{/ExerciseCompletion}" class="btn btn-primary mb-2"
					style="margin-top: 8px;"> Back</a>
				 </div>
			</div>
		</div>
	<script type="text/javascript">
		function printPageArea(areaID) {
			var printContent = document.getElementById(areaID).innerHTML;
			var printWindow = window.open('', '', 'height=700,width=1000');
			printWindow.document.write('<html><head><title>Print</title>');
			printWindow.document.write('</head><body >');
			printWindow.document.write(printContent);
			printWindow.document.write('</body></html>');
			printWindow.document.close();
			printWindow.focus();
			printWindow.print();
			printWindow.close();
		}
	</script>
	<script>
		function downloadExcel() {
			var table = document.getElementById("printableArea");
			var rows = table.getElementsByTagName("tr");
			var csv = [];
			for (var i = 0; i < rows.length; i++) {
				var row = [], cols = rows[i].querySelectorAll("td, th");
				for (var j = 0; j < cols.length; j++)
					row.push(cols[j].innerText);
				csv.push(row.join(","));
			}
			var downloadLink = document.createElement("a");
			var blob = new Blob([ "\ufeff", csv.join("\n") ], {
				type : "text/csv;charset=utf-8"
			});
			var url = URL.createObjectURL(blob);
			downloadLink.href = url;
			downloadLink.download = "data.csv";
			document.body.appendChild(downloadLink);
			downloadLink.click();
			document.body.removeChild(downloadLink);
		}
	</script>
	<br>
	<br>
	<br>
	<br>
	<br>
	<br>
	<div class="class-footer">
		<p
			style="font-family: Times New Roman; text-align: center; color: white; font-size: 18px;">
			<b>Copyright &copy; 2022 </b>
		</p>
		<p
			style="font-family: Times New Roman; text-align: center; color: white; font-size: 18px;">
			<b>Designed and Developed by CDAC</b>
		</p>
	</div>
</body>
</html>